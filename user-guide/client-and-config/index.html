<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="base-url" content="http://venusplus.cn/">
    <link type="image/png" href="/images/head.png" rel="shortcut icon" />
    <base href="http://venusplus.cn/">
    <link rel="stylesheet" href="css/main.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_18677_3gesaak2gctyb9.css">
    <link href="css/default.css" rel="stylesheet">
    <link href="css/vendor/antd.min.css" rel="stylesheet">
    <link href="css/vendor/swiper.min.css" rel="stylesheet">
    <title>Venus中间件-2.客户端选择与配置</title>
    <script src="js/vendor/jquery-3.2.1.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/common.min.js" type="text/javascript" charset="utf-8"></script>
    <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet">

  </head>
  <body data-url="/user-guide/client-and-config/" class="theme">
    
<div class="header">
  <div>
    <div class="header-wrapper">
      <div class="header-logo">
        <a href=/>
          <img src="/images/logo.png" alt="">
        </a>
      </div>
      <ul class="sofa-menu ant-menu ant-menu-horizontal ant-menu-light ant-menu-root" role="menu">
        
          <li class="ant-menu-item sofa-menu-item  ">
              
              <div class="sofa-menu-item-text">
                
                  <a href="/">首页</a>
                
                
                
              </div>
          </li>
        
          <li class="ant-menu-item sofa-menu-item  ">
              
              <div class="product-menu">
                <div class="product-menu-wrapper">
                  
                    <div class="product-menu-col">
                      <div class="product-menu-title">快速开发框架</div>
                      
                        <a href=/product/venus class="product-menu-title-link">Venus</a>
                      
                        <a href=/product/venusboot class="product-menu-title-link">Venus Boot</a>
                      
                    </div>
                  
                    <div class="product-menu-col">
                      <div class="product-menu-title">微服务框架</div>
                      
                        <a href=/product/venus-cloud class="product-menu-title-link">Venus Cloud</a>
                      
                    </div>
                  
                    <div class="product-menu-col">
                      <div class="product-menu-title">经典中间件</div>
                      
                        <a href=/product/talos class="product-menu-title-link">Talos网关</a>
                      
                    </div>
                  
                    <div class="product-menu-col">
                      <div class="product-menu-title">数据中间件</div>
                      
                        <a href=/product/venus-dts class="product-menu-title-link">Venus DTS</a>
                      
                    </div>
                  
                    <div class="product-menu-col">
                      <div class="product-menu-title">工具和公共类库</div>
                      
                        <a href=/product/venus-codegen class="product-menu-title-link">Venus CodeGen</a>
                      
                    </div>
                  
                </div>
              </div>
              
              <div class="sofa-menu-item-text">
                
                  <a href="javascript:;">产品</a>
                
                
                
              </div>
          </li>
        
          <li class="ant-menu-item sofa-menu-item  ">
              
              <div class="sofa-menu-item-text">
                
                  <a href="/#">文档</a>
                
                
                
              </div>
          </li>
        
          <li class="ant-menu-item sofa-menu-item  ">
              
              <div class="sofa-menu-item-text">
                
                  <a href="/#">控制台</a>
                
                
                
              </div>
          </li>
        
          <li class="ant-menu-item sofa-menu-item  ">
              
              <div class="sofa-menu-item-text">
                
                  <a href="/#">关于我们</a>
                
                
                
              </div>
          </li>
        

      </ul>
      <div class="sofa-menu-right pull-right">
       
        <div class="search">
          <span class="ant-input-group-wrapper" style="width: 262px;">
            <span class="ant-input-wrapper ant-input-group">
              
              <span class="ant-input-search ant-input-affix-wrapper">
                <form class="search-form" action=/search method="get">
                    <input type="text" name="q" placeholder="请输入搜索内容" value="" class="ant-input" autocomplete="off" />
                    <input type="hidden" name="title" value="新人上手">
                </form>
                <span class="ant-input-suffix">
                  <i class="anticon anticon-search ant-input-search-icon"></i>
                </span>
              </span>
            </span>
          </span>
        </div>

       
        
      </div>
    </div>
  </div>
</div>

    <div class="main">
      
  
  
    <div class="pg-artical " id="pg-artical">
      <div class="wrap">
        
<div class="nav-section">
  <div class="navbar">
    <span class="larkicon larkicon-toc"></span>
  </div>
  <nav class="nav-container">
    <ul class="catalog">
      
        
        <li class="current-book">
          <span class="name">新人上手3</span>
          <div class="liebiao-wrapper">
            
              <i id="title-liebiao-icon" class="title-liebiao-icon iconfont icon-liebiao"></i>
            

            <div class="docs-map">
              <div class="docs-map-wrapper">
                
                  
                  <div class="docs-map-item">
                    <div>
                      <h3 class="title">开发框架</h3>
                      
                        <div class="docs-map-item-link-wrapper">
                          <a class="docs-map-item-link" href="/#">Venus Framework</a>
                        </div>
                      
                    </div>
                  </div>
                  
                
                  
                  <div class="docs-map-item">
                    <div>
                      <h3 class="title">微服务框架</h3>
                      
                        <div class="docs-map-item-link-wrapper">
                          <a class="docs-map-item-link" href="/twa">Venus Cloud</a>
                        </div>
                      
                    </div>
                  </div>
                  
                
                  
                  <div class="docs-map-item">
                    <div>
                      <h3 class="title">中间件</h3>
                      
                        <div class="docs-map-item-link-wrapper">
                          <a class="docs-map-item-link" href="/talos">Talos网关</a>
                        </div>
                      
                    </div>
                  </div>
                  
                
                  
                  <div class="docs-map-item">
                    <div>
                      <h3 class="title">数据库中间件</h3>
                      
                        <div class="docs-map-item-link-wrapper">
                          <a class="docs-map-item-link" href="/venus-dts">DTS</a>
                        </div>
                      
                    </div>
                  </div>
                  
                
                  
                  <div class="docs-map-item">
                    <div>
                      <h3 class="title">工具类</h3>
                      
                        <div class="docs-map-item-link-wrapper">
                          <a class="docs-map-item-link" href="/venus-codegen">CodeGen</a>
                        </div>
                      
                    </div>
                  </div>
                  
                
                  
                  <div class="docs-map-item">
                    <div>
                      <h3 class="title">帮助中心</h3>
                      
                        <div class="docs-map-item-link-wrapper">
                          <a class="docs-map-item-link" href="/user-guide">新人上手</a>
                        </div>
                      
                    </div>
                  </div>
                  
                
              </div>
            </div>
          </div>

        </li>
        
          <li class="nav-item depth1   " data-currentPath="1" data-rootPath="1"><a href="user-guide/readme" class="">
              简介
            </a></li>
        
          <li class="nav-item depth1   " data-currentPath="2" data-rootPath="2"><a href="user-guide/product-application-intro" class="">
              产品与应用
            </a></li>
        
          <li class="nav-item depth1   " data-currentPath="3" data-rootPath="3"><a href="user-guide/sprint-intro" class="">
              应用研发
            </a></li>
        
          <li class="nav-item depth1   " data-currentPath="4" data-rootPath="4"><a href="user-guide/service-intro" class="">
              服务
            </a></li>
        
      
    </ul>
  </nav>
</div>

        <div class="main-container">
          <div id="page-toc"></div>
          <div class="artical-section larksite">
    <div class="doc-article">
      <article class="doc-article-inner">
        <div class="typo">
          <h1 class="typo-title" itemprop="title">
          2.客户端选择与配置
          </h1>
          <p class="meta">更新时间: <span>2017-2-20</span></p>
          <div class="typo-content">
            <p>仅需两步，即可使用 Basement 提供的各种服务。</p>
<h2 id="1-在-basement-上创建应用"><a class="anchor" href="#1-%E5%9C%A8-basement-%E4%B8%8A%E5%88%9B%E5%BB%BA%E5%BA%94%E7%94%A8"><span class="octicon octicon-link"></span></a> 1. 在 Basement 上创建应用</h2>
<p>访问 <a href="https://basement.alipay.com/dashboard" target="_blank" rel="noopener">Basement</a> , 填写相关信息即可创建一个应用</p>
<ul>
<li>应用创建成功后，你会获得 appId 和 masterKey，请妥善保管该信息。</li>
<li>同时注意，应用一旦创建，应用名无法修改。</li>
</ul>
<h3 id="环境"><a class="anchor" href="#%E7%8E%AF%E5%A2%83"><span class="octicon octicon-link"></span></a> 环境</h3>
<p>Basement 提供开发和生产两种环境，跟你的应用环境为如下对应关系：</p>
<table>
<thead>
<tr>
<th>Basement 环境</th>
<th>API 入口</th>
<th>你的应用环境</th>
</tr>
</thead>
<tbody>
<tr>
<td>prod</td>
<td><a href="https://basement-api.alipay.com" target="_blank" rel="noopener">https://basement-api.alipay.com</a></td>
<td>prod, pre</td>
</tr>
<tr>
<td>gzone</td>
<td><a href="https://basement-gzone.alipay.com" target="_blank" rel="noopener">https://basement-gzone.alipay.com</a></td>
<td>预发、生产环境，这个域名直接指向 gzone 的 Basement 服务，如果你的应用部署在非线上机房，使用这个 endpoint 会更快</td>
</tr>
</tbody>
</table>
<h2 id="2-选择合适的使用方式"><a class="anchor" href="#2-%E9%80%89%E6%8B%A9%E5%90%88%E9%80%82%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="octicon octicon-link"></span></a> 2. 选择合适的使用方式</h2>
<h3 id="cli-工具"><a class="anchor" href="#cli-%E5%B7%A5%E5%85%B7"><span class="octicon octicon-link"></span></a> Cli 工具</h3>
<p>如果你希望快速体验 Basement 提供的各种服务, 或者进行一些简单的操作, Cli 工具会十分方便.</p>
<p>具体的配置和试用方式请参见 <a href="user-guide/cli">Cli 工具文档</a></p>
<h3 id="chairegg-插件"><a class="anchor" href="#chairegg-%E6%8F%92%E4%BB%B6"><span class="octicon octicon-link"></span></a> Chair/Egg 插件</h3>
<p>适用于 Chair/Egg 应用</p>
<h4 id="安装"><a class="anchor" href="#%E5%AE%89%E8%A3%85"><span class="octicon octicon-link"></span></a> 安装</h4>
<pre><code class="lang-bash hljs raw">$ tnpm install @alipay/egg-basement --save
</code></pre>
<h4 id="配置"><a class="anchor" href="#%E9%85%8D%E7%BD%AE"><span class="octicon octicon-link"></span></a> 配置</h4>
<ol>
<li>打开 <code>config/plugin.js</code>，开启 basement 插件</li>
</ol>
<pre><code class="lang-js hljs raw">exports.basement = {
  <span class="hljs-attr">enable</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">package</span>: <span class="hljs-string">'@alipay/egg-basement'</span>,
};
</code></pre>
<ol>
<li>打开 <code>config/config.{env}.js</code>，编辑 basement 插件配置</li>
</ol>
<pre><code class="lang-js hljs raw">exports.basement = {
  <span class="hljs-attr">client</span>: {
    <span class="hljs-attr">appId</span>: <span class="hljs-string">'${yourAppId}'</span>,
    <span class="hljs-attr">masterKey</span>: <span class="hljs-string">'${yourMasterKey}'</span>,
    <span class="hljs-attr">env</span>: <span class="hljs-string">'${yourEnv}'</span>, <span class="hljs-comment">// 默认不需设置, 插件会自动选择环境并连接到最快的节点</span>
                       <span class="hljs-comment">// 但如果线下环境要访问 basement 线上服务, 可将该字段设为 'prod'</span>
    file: {
      <span class="hljs-attr">timeout</span>: <span class="hljs-string">'30s'</span>,  <span class="hljs-comment">// 文件上传超时时间，默认 30s</span>
    },
  },
};
</code></pre>
<p>更详细的配置方式请查看 <a href="http://web.npm.alibaba-inc.com/package/@alipay/egg-basement" target="_blank" rel="noopener">egg-basement 文档</a>。</p>
<p>现在你可以通过 <code>this.service.basement</code> 来使用 Basement 提供的服务了，例如通过 <code>this.service.basement.object</code><br />
调用数据存储服务，通过 <code>this.service.basement.render</code> 调用页面托管和渲染服务。</p>
<p>如需在 app 启动期间调用 Basement 的相关服务，可以通过 <code>app.basement</code> 来获取实例。</p>
<p>各服务用法详见使用教程或 API。</p>
<h3 id="js-sdk"><a class="anchor" href="#js-sdk"><span class="octicon octicon-link"></span></a> JS SDK</h3>
<h4 id="警告"><a class="anchor" href="#%E8%AD%A6%E5%91%8A"><span class="octicon octicon-link"></span></a> !!!警告</h4>
<p>请优先通过 Chair/Egg 插件的方式来使用 Basement，如果一定要使用该方式，请自行解决以下问题：</p>
<ol>
<li>自行跟进 SDK 版本升级的问题，SDK 会遵循 semver 发布，推荐使用 <code>^</code> 来依赖 <code>@alipay/basement</code>。</li>
<li>自行记录相关日志，否则问题无法排查。通过 urllib 的 <code>response</code> 事件来记录。</li>
<li>其他未知问题。</li>
</ol>
<h4 id="安装-1"><a class="anchor" href="#%E5%AE%89%E8%A3%85-1"><span class="octicon octicon-link"></span></a> 安装</h4>
<pre><code class="lang-bash hljs raw">$ tnpm install @alipay/basement --save
</code></pre>
<h4 id="初始化"><a class="anchor" href="#%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="octicon octicon-link"></span></a> 初始化</h4>
<pre><code class="lang-js hljs raw"><span class="hljs-keyword">const</span> Basement = <span class="hljs-built_in">require</span>(<span class="hljs-string">'@alipay/basement'</span>);

<span class="hljs-comment">// 新建一个 urllib 的实例，传入 agent 和 httpsAgent 来支持 keepalive</span>
<span class="hljs-keyword">const</span> urllib = <span class="hljs-built_in">require</span>(<span class="hljs-string">'urllib'</span>).create({
  <span class="hljs-attr">agent</span>: {yourHttpAgent},
  <span class="hljs-attr">httpsAgent</span>: {yourHttpsAgent},
});

<span class="hljs-comment">// 打印 distlog，记录所有 basement sdk 发出的请求</span>
urllib.on(<span class="hljs-string">'response'</span>, info =&gt; logger.distlog(info));

<span class="hljs-keyword">const</span> basement = <span class="hljs-keyword">new</span> Basement({
  <span class="hljs-attr">appId</span>: <span class="hljs-string">'${yourAppId}'</span>,
  <span class="hljs-attr">masterKey</span>: <span class="hljs-string">'${yourMasterKey}'</span>,
  <span class="hljs-attr">urllib</span>: urllib,
  <span class="hljs-attr">endpoint</span>: <span class="hljs-string">'http://basement.stable.alipay.net'</span>, <span class="hljs-comment">// stable 环境</span>
  <span class="hljs-comment">// endpoint: 'https://basement-api.alipay.com', // prod 环境</span>
  <span class="hljs-comment">// endpoint: 'https://basement-gzone.alipay.com', // prod 环境，但是直接指向 gzone 集群，对于线下应用访问线上 basement 服务来说会更快速</span>
  object: { <span class="hljs-comment">// object 服务的单独配置项</span>
    timeout: <span class="hljs-string">'3s'</span>, <span class="hljs-comment">// object 服务的全局超时时间</span>
  },
  <span class="hljs-attr">file</span>: {
    <span class="hljs-attr">timeout</span>: <span class="hljs-string">'30s'</span>,  <span class="hljs-comment">// 文件上传超时时间，默认 30s</span>
  }
});

<span class="hljs-comment">// 现在, 你可以通过 basement 来调用各种服务, 例如通过 basement.object 调用数据存储服务，</span>
<span class="hljs-comment">// 如 yield basement.object.listClass()</span>
<span class="hljs-comment">// 通过 basement.render 调用页面托管和渲染服务，详见使用教程或 API。</span>
</code></pre>
<p>注意：</p>
<ol>
<li>为了提高性能，请务必给 urllib 传入 agent 和 httpsAgent 来开启 <code>keepalive</code>，如何创建 agent 可以查看 <a href="https://nodejs.org/api/http.html#http_class_http_agent" target="_blank" rel="noopener">node 官方文档</a>或者 <a href="https://github.com/node-modules/agentkeepalive" target="_blank" rel="noopener">agentkeepalive</a> 模块。</li>
<li>为了问题排查方便，请务必监听 urllib 的 <code>response</code> 事件，并打印日志。请查阅 <a href="https://github.com/node-modules/urllib#global-response-event" target="_blank" rel="noopener">urllib response 事件文档</a>。</li>
<li>线下应用访问线上 Basement 服务的时候可以将 endpoint 设置为 <code>https://basement-gzone.alipay.com</code> 来加速。</li>
</ol>
<h3 id="sofa-插件"><a class="anchor" href="#sofa-%E6%8F%92%E4%BB%B6"><span class="octicon octicon-link"></span></a> Sofa 插件</h3>
<p>开发中...</p>
<h3 id="java-sdk"><a class="anchor" href="#java-sdk"><span class="octicon octicon-link"></span></a> Java SDK</h3>
<h4 id="总pom引入jar包"><a class="anchor" href="#%E6%80%BBpom%E5%BC%95%E5%85%A5jar%E5%8C%85"><span class="octicon octicon-link"></span></a> 总pom引入Jar包</h4>
<pre><code class="lang-xml hljs raw">    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alipay.basement<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>basement-util<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alipay.basement<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>basement-base<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alipay.basement<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>basement-file<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alipay.basement<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>basement-filesync<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alipay.basement<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>basement-message<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alipay.basement<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>basement-sdk<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.httpcomponents<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>httpcore<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.4.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.httpcomponents<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>httpclient<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.4.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.httpcomponents<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>httpmime<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.commons<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-codec<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h4 id="assemblyacepomxml-添加上述jar包"><a class="anchor" href="#assemblyacepomxml-%E6%B7%BB%E5%8A%A0%E4%B8%8A%E8%BF%B0jar%E5%8C%85"><span class="octicon octicon-link"></span></a> assembly/ace/pom.xml 添加上述Jar包</h4>
<h4 id="spring配置"><a class="anchor" href="#spring%E9%85%8D%E7%BD%AE"><span class="octicon octicon-link"></span></a> Spring配置</h4>
<pre><code class="lang-xml hljs raw"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;basementFactory&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.alipay.basement.sdk.BasementFactory&quot;</span>&gt;</span>
      // 请妥善保管appId, masterKey信息
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;appId&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;${appId}&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;masterKey&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;${masterKey}&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;endpoint&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;${endpoint}&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
    // endpoint: 'http://basement-api.stable.alipay.net', stable 环境
    // endpoint: 'http://basement-pool.${inner.domain}', prod 环境
        // endpoint: 'https://basement-api.alipay.com', 通过公网访问
    // endpoint: 'https://basement-gzone.alipay.com', prod 环境，但是直接指向 gzone 集群，对于线下应用访问线上 basement 服务来说会更快速

    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;fileClientConfig&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.alipay.basement.file.config.FileClientConfig&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;appName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;${appName}&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;targetEnv&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;${targetEnv}&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
            // targetEnv 部署的目标环境, DEV: 部署file到线下环境, PROD: 部署file到线上环境
        <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;cdnClientConfig&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.alipay.basement.file.config.CDNClientConfig&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;appName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;${appName}&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>

// basement file sdk
<span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;fileClient&quot;</span> <span class="hljs-attr">factory-bean</span>=<span class="hljs-string">&quot;basementFactory&quot;</span> <span class="hljs-attr">factory-method</span>=<span class="hljs-string">&quot;createFileClient&quot;</span>/&gt;</span>

// basement message sdk
<span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;messageClient&quot;</span> <span class="hljs-attr">factory-bean</span>=<span class="hljs-string">&quot;basementFactory&quot;</span> <span class="hljs-attr">factory-method</span>=<span class="hljs-string">&quot;createMessageClient&quot;</span>/&gt;</span>

// basement filesync sdk
<span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;filesyncClient&quot;</span> <span class="hljs-attr">factory-bean</span>=<span class="hljs-string">&quot;basementFactory&quot;</span> <span class="hljs-attr">factory-method</span>=<span class="hljs-string">&quot;createFilesyncClient&quot;</span>/&gt;</span>

// basement cdn sdk
<span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cdnClient&quot;</span> <span class="hljs-attr">factory-bean</span>=<span class="hljs-string">&quot;basementFactory&quot;</span> <span class="hljs-attr">factory-method</span>=<span class="hljs-string">&quot;createCDNClient&quot;</span>/&gt;</span>
</code></pre>
<h4 id="日志配置"><a class="anchor" href="#%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE"><span class="octicon octicon-link"></span></a> 日志配置</h4>
<pre><code class="lang-xml hljs raw"><span class="hljs-comment">&lt;!-- [应用Appender] Basement Httpclient 摘要日志 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">appender</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;BASEMENT-HTTPCLIENT-DIGEST-APPENDER&quot;</span>
    <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.alibaba.common.logging.spi.log4j.DailyRollingFileAppender&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file&quot;</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;${loggingRoot}/${sys_host_name}/basement-httpclient-digest.log&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;append&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;encoding&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;GBK&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">layout</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.apache.log4j.PatternLayout&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;ConversionPattern&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;%d - %m%n&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">layout</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">appender</span>&gt;</span>



<span class="hljs-comment">&lt;!-- basement httpclient 日志 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;BASEMENT-HTTPCLIENT-DIGEST&quot;</span> <span class="hljs-attr">additivity</span>=<span class="hljs-string">&quot;false&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">level</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;${superapi_loggingLevel_info}&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;BASEMENT-HTTPCLIENT-DIGEST-APPENDER&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;ERROR-APPENDER&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">logger</span>&gt;</span>
</code></pre>
<h3 id="restful-api"><a class="anchor" href="#restful-api"><span class="octicon octicon-link"></span></a> RESTFul API</h3>
<p>如果你使用的编程语言没有对应的 SDK, 可以通过直接调用 RESTFul API 的方式来使用 Basement，<br />
详见 <a href="user-guide/restful-api">RESTFul API 文档</a></p>
<h2 id="反馈"><a class="anchor" href="#%E5%8F%8D%E9%A6%88"><span class="octicon octicon-link"></span></a> 反馈</h2>
<p>文档很难理解？api 使用很不爽? 欢迎提 issue <a href="http://gitlab.alipay-inc.com/x-platform/misc/issues/new?issue%5Bassignee_id%5D=&amp;issue%5Bmilestone_id%5D=" target="_blank" rel="noopener">吐槽</a></p>
<p><a target="_blank" href="http://cp.alibaba.net/donates?id=572c3af1dbe2df9fd728fa33"><img src="http://cp.alibaba.net/projects/572c3af1dbe2df9fd728fa33/badge" /></a> 觉得不错? 果断打赏<br /><img width="150" src="http://cp.alibaba.net/projects/572c3af1dbe2df9fd728fa33/qr" /></p>

          </div>
        </div>
      </article>
    </div>
  </div>
        </div>
      </div>
    </div>
    <div class="mask hidden"></div>
    
      <script src="https://gw.alipayobjects.com/as/g/lark/site-toc/2.0.9/toc.js"></script>
<script>
  $('#page-toc').generateToc({
    contentContainer: $('.typo'),
    hasFirstLevelHeader: false,
    offsetTop: 0,
    affix: {
      bgColor: "transparent",
    },
  })
</script>

    
  

    </div>
    <div class="ant-row footer" style="background-image: linear-gradient(180deg,#050b22 0,#050b22 50%,#032158);">
  <div class="footer-content">
    <div class="ant-row footer-desc">
      <div class="ant-col-8 ant-col-offset-2 footer-team">
        <h4>我们的团队</h4>
        <p>中国，上海</p>
      </div>
      <div class="ant-col-4 ant-col-offset-2 footer-friend">
        <h4>友情链接</h4>
        <p>
          <a href="http://xujin.org">许进沉思录</a>
        </p>
        <p>
          <a href="https://springcloud.cn">Spring Cloud中国社区</a>
        </p>

      </div>
      <div class="ant-col-6 ant-col-offset-2 footer-contact">
        <h4>联系我们</h4>
        <p>业务咨询：<a href="mailto: Software_King@qq.com">Software_King@qq.com</a></p>
        <p>技术咨询：<a href="mailto: Software_King@qq.com">Software_King@qq.com</a></p>
        
      </div>
    </div>
    <div class="copyright">
      Venus Plus版权所有 &copy; 2017-2020 Venus中间件团队体系  Powered by xujin.org
    </div>
  </div>
</div>


    
    <div style="display: none">
    <script src="https://s19.cnzz.com/z_stat.php?id=1268345961&web_id=1268345961" language="JavaScript"></script>
    </div>
    
    <script>
    window.SupportConfig = {
      appId: "5a027aa32cfc95272917b0c6",
      host: "https://links.test.alipay.net/",
      bottom: "20px",
      right: "50px",
      opacity: 1
    }
    
      
      
    
    
      
      
    
  </script>
  <script>function l(){var t=d.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://links.test.alipay.net/init.js?_=1";var e=d.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}var w=window,d=document,i=function(){i.c(arguments)};i.q=[],i.c=function(t){i.q.push(t)},w.SupportNs=i,w.attachEvent?w.attachEvent("onload",l):w.addEventListener("load",l,!1);</script>
  </body>
</html>


